<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Restish Resources &mdash; Restish v1 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '',
          VERSION:     '1',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="Restish v1 documentation" href="index.html" />
    <link rel="next" title="Templating in Restish" href="templating.html" />
    <link rel="prev" title="An Introduction to Restish" href="introduction.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="templating.html" title="Templating in Restish"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="An Introduction to Restish"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Restish v1 documentation</a> &raquo;</li> 
      </ul>
    </div>  
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  
  <div class="section" id="restish-resources">
<h1>Restish Resources<a class="headerlink" href="#restish-resources" title="Permalink to this headline">¶</a></h1>
<div class="section" id="our-project-resource">
<h2>Our project resource<a class="headerlink" href="#our-project-resource" title="Permalink to this headline">¶</a></h2>
<p>The root resource you get in your project looks like this</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">import</span> <span class="nn">logging</span>
<span class="k">from</span> <span class="nn">restish</span> <span class="k">import</span> <span class="n">http</span><span class="p">,</span> <span class="n">resource</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Root</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">Resource</span><span class="p">):</span>

    <span class="nd">@resource</span><span class="o">.</span><span class="n">GET</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">ok</span><span class="p">([(</span><span class="s">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s">&#39;text/html&#39;</span><span class="p">)],</span>
            <span class="s">&quot;&lt;p&gt;Hello from myproject!&lt;/p&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="logging">
<h3>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h3>
<p>We think you should be using proper logging in your application for word go so restish makes a logger available at the top of the sample resource. You don&#8217;t need to use this but we&#8217;ve found it a lot better than print statements.</p>
</div>
<div class="section" id="resource-resource">
<h3><tt class="docutils literal"><span class="pre">resource.Resource</span></tt><a class="headerlink" href="#resource-resource" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Matt to write a little note on resource.Resource</p>
</div>
</div>
<div class="section" id="resource-get">
<h3><tt class="docutils literal"><span class="pre">&#64;resource.GET()</span></tt><a class="headerlink" href="#resource-get" title="Permalink to this headline">¶</a></h3>
<p>resource also carries most of our resource decorators and can be used for url handling or http procesing. Here were are have decorated a method of our Root resource with a resource.GET().  This tells the resource to use this method for any GET responses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Matt: add a bit about resource http handlers</p>
</div>
<p>Responses should always be either http response codes or a callable that will generate a response.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Matt: add a bit about http responses</p>
</div>
<p>In this case we have returned a http response with a content type of text/html. Let&#8217;s take a look at it.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">http</span><span class="o">.</span><span class="n">ok</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s">&#39;text/html&#39;</span><span class="p">)</span> <span class="p">],</span> <span class="s">&quot;&lt;p&gt;Hello from myproject!&lt;/p&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The response is a list of tuples, each of which is a http header key and value. This is followed by the data for the http response.</p>
</div>
<div class="section" id="other-restish-http-response-codes">
<h3>Other restish http response codes<a class="headerlink" href="#other-restish-http-response-codes" title="Permalink to this headline">¶</a></h3>
<p>We can also return a whole range of http responses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Returning <tt class="xref docutils literal"><span class="pre">None</span></tt> from a resource is equivalent to a 404</p>
</div>
<dl class="function">
<dt id="restish.http.ok">
<!--[restish.http.ok]--><tt class="descclassname">restish.http.</tt><tt class="descname">ok</tt><big>(</big><em>headers</em>, <em>body</em><big>)</big><a class="headerlink" href="#restish.http.ok" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="restish.http.created">
<!--[restish.http.created]--><tt class="descclassname">restish.http.</tt><tt class="descname">created</tt><big>(</big><em>location</em>, <em>body</em>, <em>headers=None</em><big>)</big><a class="headerlink" href="#restish.http.created" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="restish.http.moved_permanently">
<!--[restish.http.moved_permanently]--><tt class="descclassname">restish.http.</tt><tt class="descname">moved_permanently</tt><big>(</big><em>location</em><big>)</big><a class="headerlink" href="#restish.http.moved_permanently" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="restish.http.found">
<!--[restish.http.found]--><tt class="descclassname">restish.http.</tt><tt class="descname">found</tt><big>(</big><em>location</em><big>)</big><a class="headerlink" href="#restish.http.found" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="restish.http.see_other">
<!--[restish.http.see_other]--><tt class="descclassname">restish.http.</tt><tt class="descname">see_other</tt><big>(</big><em>location</em><big>)</big><a class="headerlink" href="#restish.http.see_other" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="restish.http.not_modified">
<!--[restish.http.not_modified]--><tt class="descclassname">restish.http.</tt><tt class="descname">not_modified</tt><big>(</big><big>)</big><a class="headerlink" href="#restish.http.not_modified" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="restish.http.bad_request">
<!--[restish.http.bad_request]--><tt class="descclassname">restish.http.</tt><tt class="descname">bad_request</tt><big>(</big><em>headers=None</em>, <em>body=None</em><big>)</big><a class="headerlink" href="#restish.http.bad_request" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="restish.http.unauthorized">
<!--[restish.http.unauthorized]--><tt class="descclassname">restish.http.</tt><tt class="descname">unauthorized</tt><big>(</big><em>headers=None</em>, <em>body=None</em><big>)</big><a class="headerlink" href="#restish.http.unauthorized" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="restish.http.forbidden">
<!--[restish.http.forbidden]--><tt class="descclassname">restish.http.</tt><tt class="descname">forbidden</tt><big>(</big><em>headers</em>, <em>body</em><big>)</big><a class="headerlink" href="#restish.http.forbidden" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="restish.http.not_found">
<!--[restish.http.not_found]--><tt class="descclassname">restish.http.</tt><tt class="descname">not_found</tt><big>(</big><em>headers=None</em>, <em>body=None</em><big>)</big><a class="headerlink" href="#restish.http.not_found" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="restish.http.method_not_allowed">
<!--[restish.http.method_not_allowed]--><tt class="descclassname">restish.http.</tt><tt class="descname">method_not_allowed</tt><big>(</big><em>allow</em><big>)</big><a class="headerlink" href="#restish.http.method_not_allowed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="restish.http.not_acceptable">
<!--[restish.http.not_acceptable]--><tt class="descclassname">restish.http.</tt><tt class="descname">not_acceptable</tt><big>(</big><em>headers</em>, <em>body</em><big>)</big><a class="headerlink" href="#restish.http.not_acceptable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="restish.http.conflict">
<!--[restish.http.conflict]--><tt class="descclassname">restish.http.</tt><tt class="descname">conflict</tt><big>(</big><em>headers</em>, <em>body</em><big>)</big><a class="headerlink" href="#restish.http.conflict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>
<div class="section" id="content-negotiation">
<h2>Content Negotiation<a class="headerlink" href="#content-negotiation" title="Permalink to this headline">¶</a></h2>
<p>Resources can perform content negotiation in a few different ways. The example above where <tt class="docutils literal"><span class="pre">GET()</span></tt> had not arguments accepts any (or no) content type. If we wanted to explictly return different types of document depending on the accept headers we can include this as a GET argument.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@resource</span><span class="o">.</span><span class="n">GET</span><span class="p">(</span><span class="n">accept</span><span class="o">=</span><span class="s">&#39;application/json&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">ok</span><span class="p">([(</span><span class="s">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s">&#39;application/json&#39;</span><span class="p">)],</span> <span class="s">&quot;{}&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, if the accept header was application/json, our empty json string would be returned.</p>
<p>If we had our argument-less GET resource also, then this would act as a &#8216;catch-all&#8217; where everything apart from &#8216;application/json&#8217; would return html. e.g.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@resource</span><span class="o">.</span><span class="n">GET</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">catchall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">ok</span><span class="p">([(</span><span class="s">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s">&#39;text/html&#39;</span><span class="p">)],</span> <span class="s">&quot;&lt;strong&gt;I&#39;m HTML&lt;/strong&gt;&quot;</span><span class="p">)</span>

<span class="nd">@resource</span><span class="o">.</span><span class="n">GET</span><span class="p">(</span><span class="n">accept</span><span class="o">=</span><span class="s">&#39;application/json&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">ok</span><span class="p">([(</span><span class="s">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s">&#39;application/json&#39;</span><span class="p">)],</span> <span class="s">&quot;{}&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can use shorten <tt class="docutils literal"><span class="pre">text/html</span></tt> and <tt class="docutils literal"><span class="pre">text/json</span></tt> to just <tt class="docutils literal"><span class="pre">html</span></tt> and <tt class="docutils literal"><span class="pre">json</span></tt>.</p>
<p>Wildcard content type matching also works. e.g. <tt class="docutils literal"><span class="pre">text/*</span></tt></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Content negotiation within restish also honours the clients accept-quality scores. e.g. if a client sends <tt class="docutils literal"><span class="pre">text/html;q=0.4,text/plain;q=0.5</span></tt> text/plain will be preferred. See <a class="reference" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html">http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html</a></p>
</div>
<p>We sometimes want to match lists of content types, for example where we would like to use <tt class="docutils literal"><span class="pre">application/xhtml+xml</span></tt>. This are honoured by restish. (See test_resource.py in the unit tests for examples)</p>
</div>
<div class="section" id="resource-url-handling">
<h2>Resource URL Handling<a class="headerlink" href="#resource-url-handling" title="Permalink to this headline">¶</a></h2>
<p>Restish implements a <tt class="docutils literal"><span class="pre">resource_child</span></tt> method on each resource which checks it&#8217;s registered <tt class="docutils literal"><span class="pre">matchers</span></tt> to see if they are successful. If they are not, then None is returned (which is the same as a 404 response).</p>
<p>Matchers are any callable that returns another resource and a list of remaining segments.</p>
<p>As far as most applications are concerned, they need not implement anything beyond the included matcher which is wired by default into the <tt class="docutils literal"><span class="pre">resource.child</span></tt> decorator. The uses of this method are described in the following sections.</p>
<div class="section" id="implicitly-named-child">
<h3>Implicitly named child<a class="headerlink" href="#implicitly-named-child" title="Permalink to this headline">¶</a></h3>
<p>This takes it&#8217;s segment matching from the method name. For instance, this code will match a segment named <tt class="docutils literal"><span class="pre">thanks</span></tt> and ignore any remaining segments. So if this were a root resource, it would match <tt class="docutils literal"><span class="pre">/thanks</span></tt> and <tt class="docutils literal"><span class="pre">/thanks/foo/bar</span></tt>, amongst others.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@resource</span><span class="o">.</span><span class="n">child</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">thanks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">segments</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">ok</span><span class="p">(</span> <span class="p">[(</span><span class="s">&#39;Content-Type&#39;</span><span class="p">,</span><span class="s">&#39;text/html&#39;</span><span class="p">)],</span> <span class="s">&#39;thanks&#39;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="explicitly-named-child">
<h3>Explicitly named child<a class="headerlink" href="#explicitly-named-child" title="Permalink to this headline">¶</a></h3>
<p>Obviously this won&#8217;t work where you have urls with non-python method name characters (for example a stylesheet). For this you can pass an explicit child name to the <tt class="docutils literal"><span class="pre">resource.child</span></tt> decorator.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@resource</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="s">&#39;styles.css&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">styles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">segments</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">ok</span><span class="p">(</span> <span class="p">[(</span><span class="s">&#39;Content-Type&#39;</span><span class="p">,</span><span class="s">&#39;text/css&#39;</span><span class="p">)],</span> <span class="s">&#39;body { color: red; }&#39;</span> <span class="p">)</span>
</pre></div>
</div>
<p>For any non-trivial application, you would want to handle a segment and pass everything below it to the next resource.</p>
</div>
<div class="section" id="chaining-resources">
<h3>Chaining Resources<a class="headerlink" href="#chaining-resources" title="Permalink to this headline">¶</a></h3>
<p>We&#8217;re showing a contrived example where the url <tt class="docutils literal"><span class="pre">/blog/entries/28</span></tt> get&#8217;s passed down from resource to resource.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Root</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">Resource</span><span class="p">):</span>

    <span class="nd">@resource</span><span class="o">.</span><span class="n">child</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">blog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">segments</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Blog</span><span class="p">(),</span> <span class="n">segments</span>

<span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">Resource</span><span class="p">):</span>

    <span class="nd">@resource</span><span class="o">.</span><span class="n">child</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">entries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">segments</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Entry</span><span class="p">(),</span> <span class="n">segments</span>

<span class="k">class</span> <span class="nc">Entries</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">Resource</span><span class="p">):</span>

    <span class="nd">@resource</span><span class="o">.</span><span class="n">GET</span><span class="p">()</span>
    <span class="nd">@templating</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="s">&#39;entry.html&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="n">blogcontent</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">&#39;content&#39;</span><span class="p">:</span> <span class="n">blogcontent</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="template-resource-matchers">
<h3>Template Resource Matchers<a class="headerlink" href="#template-resource-matchers" title="Permalink to this headline">¶</a></h3>
<p>OK so that wasn&#8217;t the most realistic example, for sites like blogger you would want to pick up the year and month and then the blog entry name. We can do this using the template style url matcher. We&#8217;ll try that now..</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Root</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">Resource</span><span class="p">):</span>

    <span class="nd">@resource</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="s">&#39;{year}/{month}&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">blog_month_entries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">BlogList</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">),</span> <span class="n">segments</span>

    <span class="nd">@resource</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="s">&#39;{year}/{month}/{entryid}&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">blog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">BlogPost</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">),</span> <span class="n">segments</span>

<span class="k">class</span> <span class="nc">BlogList</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">Resource</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span>

    <span class="nd">@resource</span><span class="o">.</span><span class="n">GET</span><span class="p">()</span>
    <span class="nd">@templating</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="s">&#39;EntryList.html&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">entrylist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="n">entries</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">&#39;entries&#39;</span><span class="p">:</span> <span class="n">entries</span><span class="p">}</span>


<span class="k">class</span> <span class="nc">BlogPost</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">Resource</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entryid</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entryid</span><span class="o">=</span><span class="n">entryid</span>

    <span class="nd">@resource</span><span class="o">.</span><span class="n">GET</span><span class="p">()</span>
    <span class="nd">@templating</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="s">&#39;entry.html&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="n">blogcontent</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entryid</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">&#39;content&#39;</span><span class="p">:</span> <span class="n">blogcontent</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-matchers">
<h3>Custom Matchers<a class="headerlink" href="#custom-matchers" title="Permalink to this headline">¶</a></h3>
<p>You can pass your own matchers to the child method if you like. For instance, let&#8217;s process the following search url <tt class="docutils literal"><span class="pre">/search/python?u=foo</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">mymatcher</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">segments</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span> <span class="o">&gt;</span><span class="mf">2</span> <span class="ow">and</span> <span class="n">segments</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;search&#39;</span><span class="p">:</span>
        <span class="n">category</span> <span class="o">=</span> <span class="n">segments</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span>
        <span class="n">search_string</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;category&#39;</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span> <span class="s">&#39;search_string&#39;</span><span class="p">:</span> <span class="n">search_string</span><span class="p">},</span> <span class="p">()</span>

<span class="k">class</span> <span class="nc">Root</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">Resource</span><span class="p">):</span>

    <span class="nd">@resource</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="n">mymatcher</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">segments</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">SearchResults</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">SearchResults</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">Resource</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="o">=</span><span class="n">kw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;category&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_string</span><span class="o">=</span><span class="n">kw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;search_string&#39;</span><span class="p">)</span>

    <span class="nd">@resource</span><span class="o">.</span><span class="n">GET</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="p">,</span> <span class="n">search_term</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_term</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple">
<li>Other methods<ul>
<li>PUT, DELETE</li>
</ul>
</li>
</ol>
<ol class="arabic simple" start="5">
<li>example of a cookie wsgi app<ul>
<li>Building the app</li>
<li>installing the app</li>
</ul>
</li>
<li>example of a flashmessage wsgi app<ul>
<li>Building the app</li>
<li>installing the app</li>
</ul>
</li>
<li>Implementing guards<ul>
<li>using a basic guard</li>
<li>using repoze.who</li>
</ul>
</li>
<li>Examples<ul>
<li>A rest api server</li>
</ul>
</li>
<li>Using formish within restish<ul>
<li>Typical pattern</li>
<li>multiple forms</li>
</ul>
</li>
</ol>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference" href="">Restish Resources</a><ul>
<li><a class="reference" href="#our-project-resource">Our project resource</a><ul>
<li><a class="reference" href="#logging">Logging</a></li>
<li><a class="reference" href="#resource-resource"><tt class="docutils literal"><span class="pre">resource.Resource</span></tt></a></li>
<li><a class="reference" href="#resource-get"><tt class="docutils literal"><span class="pre">&#64;resource.GET()</span></tt></a></li>
<li><a class="reference" href="#other-restish-http-response-codes">Other restish http response codes</a></li>
</ul>
</li>
<li><a class="reference" href="#content-negotiation">Content Negotiation</a></li>
<li><a class="reference" href="#resource-url-handling">Resource URL Handling</a><ul>
<li><a class="reference" href="#implicitly-named-child">Implicitly named child</a></li>
<li><a class="reference" href="#explicitly-named-child">Explicitly named child</a></li>
<li><a class="reference" href="#chaining-resources">Chaining Resources</a></li>
<li><a class="reference" href="#template-resource-matchers">Template Resource Matchers</a></li>
<li><a class="reference" href="#custom-matchers">Custom Matchers</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="introduction.html" title="previous chapter">An Introduction to Restish</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="templating.html" title="next chapter">Templating in Restish</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/resources.txt">Show Source</a></li>
            </ul>
          <h3>Quick search</h3>
            <form class="search" action="search.html" method="get">
              <input type="text" name="q" size="18" /> <input type="submit" value="Go" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="templating.html" title="Templating in Restish"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="An Introduction to Restish"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Restish v1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2008, Tim Parkin, Matt Goodall.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.5.
    </div>
  </body>
</html>